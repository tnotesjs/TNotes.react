# [0023. è®¤è¯†ç±»ç»„ä»¶](https://github.com/tnotesjs/TNotes.react/tree/main/notes/0023.%20%E8%AE%A4%E8%AF%86%E7%B1%BB%E7%BB%84%E4%BB%B6)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„ä»·](#2--è¯„ä»·)
- [3. ğŸ¤” â€œç±»ç»„ä»¶â€æ˜¯ä»€ä¹ˆï¼Ÿ](#3--ç±»ç»„ä»¶æ˜¯ä»€ä¹ˆ)
- [4. ğŸ¤” â€œå‡½æ•°ç»„ä»¶â€å’Œâ€œç±»ç»„ä»¶â€ç”¨å“ªä¸ªï¼Ÿ](#4--å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶ç”¨å“ªä¸ª)
- [5. ğŸ¤” å¦‚ä½•ç®¡ç†ç±»ç»„ä»¶çš„çŠ¶æ€ï¼ˆStateï¼‰ï¼Ÿ](#5--å¦‚ä½•ç®¡ç†ç±»ç»„ä»¶çš„çŠ¶æ€state)
- [6. ğŸ¤” ç±»ç»„ä»¶çš„â€œç”Ÿå‘½å‘¨æœŸæ–¹æ³•â€æ˜¯ï¼Ÿ](#6--ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ˜¯)
- [7. ğŸ”— å¼•ç”¨](#7--å¼•ç”¨)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- ç±»ç»„ä»¶ç®€ä»‹

## 2. ğŸ«§ è¯„ä»·

- éšç€ React Hooks çš„å¼•å…¥ï¼Œè®¸å¤šåŸæœ¬åªèƒ½åœ¨ç±»ç»„ä»¶ä¸­å®Œæˆçš„ä»»åŠ¡ç°åœ¨ä¹Ÿå¯ä»¥åœ¨å‡½æ•°ç»„ä»¶ä¸­å®ç°ï¼Œè¿™ä½¿å¾—å‡½æ•°ç»„ä»¶æˆä¸ºäº†æ–°çš„æ ‡å‡†ã€‚
- è¯è™½å¦‚æ­¤ï¼Œäº†è§£ç±»ç»„ä»¶ä»ç„¶æ˜¯è›®é‡è¦çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨å¾ˆå¤šç°æœ‰çš„ React æ—§é¡¹ç›®ä¸­ä»ç„¶å¹¿æ³›ä½¿ç”¨ï¼Œå’±ä»¬åœ¨çœ‹ä¸€äº›å¼€æºé¡¹ç›®ï¼ˆæ¯”å¦‚ç›®å‰ 2025 å¹´çš„ [scratch-gui][1]ï¼‰çš„æ—¶å€™ï¼Œä½ ä¾æ—§ä¼šçœ‹åˆ°ä¸å°‘çš„ç±»ç»„ä»¶çš„ä½¿ç”¨ã€‚

## 3. ğŸ¤” â€œç±»ç»„ä»¶â€æ˜¯ä»€ä¹ˆï¼Ÿ

- ç±»ç»„ä»¶æ˜¯ React ä¸­å®šä¹‰ç»„ä»¶çš„å¦ä¸€ç§æ–¹å¼ï¼Œå®ƒåŸºäº ES6 çš„ç±»ï¼ˆclassï¼‰è¯­æ³•ã€‚
- ç±»ç»„ä»¶æ‰©å±•äº† `React.Component` ç±»ï¼Œå¹¶ä¸”å¿…é¡»å®ç°ä¸€ä¸ªåä¸º `render` çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›è¦æ¸²æŸ“åˆ° DOM çš„ JSX ä»£ç ã€‚
- ç±»ç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ï¼ˆstateï¼‰å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè¿™ä½¿å¾—å®ƒä»¬åœ¨å¤„ç†å¤æ‚é€»è¾‘æ—¶éå¸¸æœ‰ç”¨ã€‚
- ä¸€ä¸ªåŸºæœ¬çš„ç±»ç»„ä»¶çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```jsx
import React, { Component } from 'react'

class Welcome extends Component {
  render() {
    return <h1>Hello, {this.props.name}</h1>
  }
}
```

- æ³¨è§£ï¼š
  - åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`Welcome` æ˜¯ä¸€ä¸ªç±»ç»„ä»¶ï¼Œå®ƒç»§æ‰¿è‡ª `React.Component`ã€‚
  - `render` æ–¹æ³•è¿”å›äº†ä¸€ä¸ª `<h1>` å…ƒç´ ï¼Œå…¶ä¸­åŒ…å«äº†é€šè¿‡ `this.props` ä¼ é€’è¿›æ¥çš„ `name` å±æ€§ã€‚

## 4. ğŸ¤” â€œå‡½æ•°ç»„ä»¶â€å’Œâ€œç±»ç»„ä»¶â€ç”¨å“ªä¸ªï¼Ÿ

- åœ¨æ—©æœŸï¼Œç±»ç»„ä»¶æ˜¯ä¸»æµï¼Œå› ä¸ºå‡½æ•°ç»„ä»¶æ˜¯æ²¡æœ‰çŠ¶æ€ï¼ˆstateï¼‰å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ï¼Œå½“æ—¶çš„å‡½æ•°ç»„ä»¶ä»…ç”¨æ¥åšä¸€äº›ç®€å•çš„æ¨¡æ¿å±•ç¤ºã€‚
- ç°åœ¨ï¼Œå‡½æ•°ç»„ä»¶æœ‰äº† Hooksï¼Œå¹¶ä¸”å†™èµ·æ¥æ¯”ç±»ç»„ä»¶æ›´ä¸ºç®€æ´ï¼Œå®˜æ–¹ä¹Ÿæ›´æ¨èé‡‡ç”¨å‡½æ•°ç»„ä»¶çš„å½¢å¼æ¥å®šä¹‰ç»„ä»¶ã€‚

## 5. ğŸ¤” å¦‚ä½•ç®¡ç†ç±»ç»„ä»¶çš„çŠ¶æ€ï¼ˆStateï¼‰ï¼Ÿ

- ç±»ç»„ä»¶å¯ä»¥é€šè¿‡ `this.state` æ¥ç®¡ç†è‡ªå·±çš„çŠ¶æ€ã€‚
- çŠ¶æ€æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œå¹¶é€šè¿‡ `this.setState` æ–¹æ³•æ¥æ›´æ–°ã€‚
- å½“çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“ã€‚

```jsx
class Counter extends Component {
  constructor(props) {
    super(props)
    this.state = { count: 0 }
  }

  incrementCount = () => {
    this.setState({ count: this.state.count + 1 })
  }

  render() {
    return (
      <div>
        <p>Count: {this.state.count}</p>
        <button onClick={this.incrementCount}>Increment</button>
      </div>
    )
  }
}
```

- åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`Counter` ç»„ä»¶æœ‰ä¸€ä¸ª `count` çŠ¶æ€ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæŒ‰é’®æ¥å¢åŠ è¿™ä¸ªè®¡æ•°å™¨çš„å€¼ã€‚

## 6. ğŸ¤” ç±»ç»„ä»¶çš„â€œç”Ÿå‘½å‘¨æœŸæ–¹æ³•â€æ˜¯ï¼Ÿ

- ç±»ç»„ä»¶çš„"ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"æ˜¯æŒ‡åœ¨ç»„ä»¶ä¸åŒé˜¶æ®µè‡ªåŠ¨è°ƒç”¨çš„ç‰¹æ®Šæ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…åœ¨ç»„ä»¶çš„ç‰¹å®šæ—¶åˆ»æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚
- ç±»ç»„ä»¶æä¾›äº†å¤šç§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å…è®¸ä½ åœ¨ç»„ä»¶çš„ä¸åŒé˜¶æ®µæ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚
- ä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸è§çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š

| ç”Ÿå‘½å‘¨æœŸæ–¹æ³• | è¯´æ˜ |
| --- | --- |
| `constructor` | åˆå§‹åŒ– state å’Œç»‘å®šäº‹ä»¶å¤„ç†å™¨ |
| `componentDidMount` | åœ¨ç»„ä»¶æŒ‚è½½åç«‹å³è°ƒç”¨ï¼Œé€šå¸¸ç”¨æ¥å‘é€ç½‘ç»œè¯·æ±‚æˆ–è®¾ç½®è®¢é˜… |
| `shouldComponentUpdate` | å†³å®šæ˜¯å¦éœ€è¦æ›´æ–°ç»„ä»¶ï¼Œå¯ä»¥ç”¨äºæ€§èƒ½ä¼˜åŒ– |
| `componentDidUpdate` | åœ¨ç»„ä»¶æ›´æ–°åè°ƒç”¨ï¼Œå¯ä»¥ç”¨æ¥è§¦å‘ç½‘ç»œè¯·æ±‚æˆ–è¿›è¡Œ DOM æ“ä½œ |
| `componentWillUnmount` | åœ¨ç»„ä»¶å¸è½½å‰è°ƒç”¨ï¼Œç”¨äºæ¸…ç†å·¥ä½œï¼Œå¦‚å–æ¶ˆè®¢é˜…æˆ–æ¸…é™¤å®šæ—¶å™¨ |

```jsx
class Example extends Component {
  constructor(props) {
    super(props)
    this.state = { data: null }
  }

  componentDidMount() {
    // æ¨¡æ‹Ÿå¼‚æ­¥æ•°æ®è·å–
    setTimeout(() => {
      this.setState({ data: 'Data fetched' })
    }, 2000)
  }

  componentDidUpdate(prevProps, prevState) {
    if (prevState.data !== this.state.data) {
      console.log('Data has changed:', this.state.data)
    }
  }

  componentWillUnmount() {
    console.log('Component will unmount')
  }

  render() {
    return <div>{this.state.data || 'Loading...'}</div>
  }
}
```

- åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`Example` ç»„ä»¶åœ¨æŒ‚è½½åæ¨¡æ‹Ÿäº†ä¸€ä¸ªæ•°æ®è·å–çš„è¿‡ç¨‹ï¼Œå¹¶åœ¨æ•°æ®æ›´æ–°æ—¶è®°å½•ä¸€æ¡æ¶ˆæ¯ã€‚åŒæ—¶ï¼Œå½“ç»„ä»¶å³å°†å¸è½½æ—¶ï¼Œå®ƒä¹Ÿä¼šè®°å½•ä¸€æ¡æ¶ˆæ¯ã€‚
- åœ¨ä½¿ç”¨ç›¸å…³ç”Ÿå‘½å‘¨æœŸ API çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä½ å½“å‰æ‰€ä½¿ç”¨çš„ React ç‰ˆæœ¬ï¼Œåœ¨ä¸åŒçš„ React ç‰ˆæœ¬ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸ API ä¼šæœ‰æ‰€å·®å¼‚ã€‚
- å…·ä½“çš„ç‰ˆæœ¬å˜æ›´ï¼Œå¯ä»¥æŸ¥é˜… [react å®˜æ–¹çš„ CHANGELOG][2] æè¿°ã€‚

## 7. ğŸ”— å¼•ç”¨

- [scratch-gui][1]
- [react å®˜æ–¹çš„ CHANGELOG][2]

[1]: https://github.com/scratchfoundation/scratch-gui
[2]: https://github.com/facebook/react/blob/main/CHANGELOG.md
